---
prev: "arfs.md"
next: "entity-types.md"
---

# データモデル

Arweaveの永久不変の性質により、ファイルやフォルダーの名前変更や移動といった従来のファイル構造操作は、オンチェーンデータを単に更新することでは達成できません。ArFSは、Arweaveの[トランザクションヘッダー](https://docs.arweave.org/developers/server/http-api#transaction-format)に見られるメタデータタグに基づく追記専用のトランザクションデータモデルを定義することでこれを回避しています。

このモデルはボトムアップの参照方式を使用しており、ファイルシステムの更新時に発生するレースコンディションを回避します。各ファイルには親フォルダーを指すメタデータが含まれ、各フォルダーにはその親ドライブを指すメタデータが含まれています。トップダウンのデータモデルでは、親モデル（つまりフォルダー）がその子供の参照を保持する必要があります。

これらの定義されたエンティティにより、クライアントはドライブの状態を構築してファイルシステムのように見えるようにできます。

- ドライブエンティティにはフォルダーとファイルが含まれます
- フォルダーエンティティには他のフォルダーやファイルが含まれます
- ファイルエンティティにはファイルデータとメタデータの両方が含まれます
- スナップショットエンティティにはドライブ内のすべてのファイルとフォルダーメタデータの状態がロールアップされて含まれます

## エンティティの関係

以下の図は、ドライブ、フォルダー、およびファイルエンティティ間の高レベルの関係とそれに関連するデータを示しています。各エンティティタイプに関する詳細な情報は[こちら](./entity-types.md)で確認できます。

<img :src="$withBase('/entity-relationship-diagram.png')" style="height: auto; display: block; margin-left: auto; margin-right: auto; width: 75%;">

<div style="text-align: center; font-size: .75em;">エンティティ関係図</div>

ご覧の通り、各ファイルとフォルダーには親フォルダーと親ドライブの両方を指すメタデータが含まれています。ドライブエンティティは自分自身に関するメタデータを含んでいますが、子の内容については含んでいません。したがって、クライアントは最低レベルからドライブの状態を構築し、上に進んでいかなければなりません。

## メタデータ形式

Arweaveのトランザクションタグに保存されるメタデータは、以下のように定義されます。


```json
{ "name": "Example-Tag", "value": "example-data" }
```

トランザクションデータペイロードに保存されるメタデータは、以下のようにJSON形式に従います。

```json
{
    "exampleField": "exampleData"
}
```

`?`が付くフィールドはオプションです。

```json
{
  "name": "My Project",
  "description": "This is a sample project.",
  "version?": "1.0.0",
  "author?": "John Doe"
}
```

列挙されたフィールド値（特定の値に従う必要があるもの）は、「値1 | 値2」という形式で定義されます。

エンティティIDに使用されるすべてのUUIDは、[ユニバーサリー一意識別子](https://en.wikipedia.org/wiki/Universally_unique_identifier)の標準に基づいています。

ArFSタグを特定の順序でリストする必要はありません。
